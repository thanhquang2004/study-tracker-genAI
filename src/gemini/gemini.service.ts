import { Injectable } from '@nestjs/common';
import { ConfigService } from '@nestjs/config';
import { GoogleGenerativeAI } from '@google/generative-ai';
import { PrismaService } from 'src/prisma/prisma.service';
import { User } from '@prisma/client';
import { GenerateQuizDto } from './dto/generateQuiz.dto';

@Injectable()
export class GeminiService {
  private genAI: any;
  private model: any;
  private generationConfig: any;

  constructor(
    private readonly configService: ConfigService,
    private readonly prismaService: PrismaService,
  ) {
    this.genAI = new GoogleGenerativeAI(configService.get('GOOGLE_API_KEY'));

    this.model = this.genAI.getGenerativeModel({ model: 'gemini-1.5-flash' });

    this.generationConfig = {
      temperature: 0.65,
      topP: 0.95,
      topK: 64,
      maxOutputTokens: 800,
      responseMimeType: 'application/json',
    };
  }

  async generateQuestion1(info: string) {
    const parts = [
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\n\nUser Input:\nPersonal or Career Goals: Study AWS\nGoal: AWS Solutions Architect Associate certification\nExperience Level: Beginner\n\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify  technologies or skills they need to learn\nanswer: A placeholder for the user\'s answer to the question.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nUsers will often learn on their own, so they will often learn using videos or online resources and without instructors.\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing next information and don\'t duplicate information in User Input. If in User Input there is no information related to the skills the user already has related to the goal, ask a question about it.\nexampleAnswer should be diverse and relevant to the question, including popular frameworks and underlying technologies.(3 example answers)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation(if enough return true, if not return false), if User input have 6 line return true.',
      },
      {
        text: 'output: {"nextQuestion": "What specific AWS services are you most interested in learning about or working with?","answer": "Services: ", "exampleAnswer": [{"content": "EC2 (Elastic Compute Cloud)"}, {"content": "S3 (Simple Storage Service)"}, {"content": "Lambda (Serverless Computing)"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals:  Play piano\nExperience Level: Beginner\nStyle: Romantic\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify  technologies or skills they need to learn.\nanswer: A placeholder for the user\'s answer to the question.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nUsers will often learn on their own, so they will often learn using videos or online resources and without instructors.\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing next information and don\'t duplicate information in User Input. If in User Input there is no information related to the skills the user already has related to the goal, ask a question about it.\nexampleAnswer should be diverse and relevant to the question, including popular frameworks and underlying technologies.(3 example answers)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation(if enough return true, if not return false), if User input have 6 line return true.',
      },
      {
        text: 'output: {"nextQuestion": "What specific pieces of classical music do you enjoy or are interested in learning?","answer": "Music: ", "exampleAnswer": [{"content": "Mozart Sonatas"}, {"content": "Bach Preludes and Fugues"}, {"content": "Beethoven Piano Concertos"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals:  Study desgin\nType: Graphic Design\nSpecific: Logo design\n\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify  technologies or skills they need to learn\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nUsers will often learn on their own, so they will often learn using videos or online resources and without instructors.\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing next information and don\'t duplicate information in User Input. If in User Input there is no information related to the skills the user already has related to the goal, ask a question about it.\nexampleAnswer should be diverse and relevant to the question, including popular frameworks and underlying technologies.(3 example answers)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation(if enough return true, if not return false), if User input have 6 line return true.',
      },
      {
        text: 'output: {"nextQuestion": "What specific software or tools are you interested in learning for logo design?", "answer": "Software: ", "exampleAnswer": [{"content": "Adobe Illustrator"}, {"content": "Canva"}, {"content": "Figma"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals:  Learn programming\nLanguage: Python\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify  technologies or skills they need to learn.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nUsers will often learn on their own, so they will often learn using videos or online resources.\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing next information and don\'t duplicate information in User Input. If in User Input there is no information related to the skills the user already has related to the goal, ask a question about it.\nexampleAnswer should be diverse and relevant to the question, including popular frameworks and underlying technologies.(3 example answers)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation(if enough return true, if not return false), if User input have 6 line return true.',
      },
      {
        text: 'output: {"nextQuestion": "What specific areas or applications of Python are you most interested in?", "answer": "Areas: ", "exampleAnswer": [{"content": "Data Science and Machine Learning"}, {"content": "Web Development"}, {"content": "Automation and Scripting"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals: Learn communication\nSpecific: Public Speaking \n\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify  technologies or skills they need to learn\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nUsers will often learn on their own, so they will often learn using videos or online resources and without instructors.\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing next information and don\'t duplicate information in User Input. If in User Input there is no information related to the skills the user already has related to the goal, ask a question about it.\nexampleAnswer should be diverse and relevant to the question, including popular frameworks and underlying technologies.(3 example answers)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation(if enough return true, if not return false), if User input have 6 line return true.',
      },
      {
        text: 'output: {"nextQuestion": "What specific types of public speaking are you interested in or do you need to develop skills for?", "answer": "Type: ", "exampleAnswer": [{"content": "Presentations at work"}, {"content": "Public speeches"}, {"content": "Toastmastering"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals:  Learn painting \nStyle: Acrylic\n\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify the most specific technologies or skills they need to learn.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing next information and don\'t duplicate information in User Input.If in User Input there is no information related to the skills the user already has related to the goal, ask a question about it.\nexampleAnswer should be diverse and relevant to the question, including popular frameworks and underlying technologies.(3 example answers)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation(if enough return true, if not return false), if User input have 6 line return true.',
      },
      {
        text: 'output: {"nextQuestion": "What specific subjects or types of acrylic painting are you interested in exploring?", "answer": "Subjects: ", "exampleAnswer": [{"content": "Landscapes"}, {"content": "Portraits"}, {"content": "Abstract Art"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals:  Learn content creation\nInterested: Blog post\nTopic: Food\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify the most specific technologies or skills they need to learn.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing next information.\nexampleAnswer should be diverse and relevant to the question, including popular frameworks and underlying technologies.(3 example answers)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation(if enough return true, if not return false), if User input have 6 line return true.',
      },
      {
        text: 'output: {"nextQuestion": "What specific type of food blog are you interested in creating?", "answer": "Food Type: ", "exampleAnswer": [{"content": "Recipes"}, {"content": "Restaurant Reviews"}, {"content": "Food Photography and Styling"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals: Learn French \nLevel: Basic knowledge\nGoal: Basic communicate\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify the most specific technologies or skills they need to learn.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing next information.\nexampleAnswer should be diverse and relevant to the question, including popular frameworks and underlying technologies.(3 example answers)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation(if enough return true, if not return false), if User input have 6 line return true.',
      },
      {
        text: 'output: {"nextQuestion": "What are your specific communication goals in French? (e.g., travel, work, social interaction)", "answer": "Goals: ", "exampleAnswer": [{"content": "Traveling to France"}, {"content": "Working in a French-speaking environment"}, {"content": "Socializing with French speakers"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals:  Learn how to tip beautiful photos\nTools: Iphone \n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify  technologies or skills they need to learn\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nUsers will often learn on their own, so they will often learn using videos or online resources and without instructors.\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing next information and don\'t duplicate information in User Input. If in User Input there is no information related to the skills the user already has related to the goal, ask a question about it.\nexampleAnswer should be diverse and relevant to the question, including popular frameworks and underlying technologies.(3 example answers)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation(if enough return true, if not return false), if User input have 6 line return true.',
      },
      {
        text: 'output: {"nextQuestion": "What specific aspects of photo editing are you most interested in learning for your iPhone?", "answer": "Aspects: ", "exampleAnswer": [{"content": "Basic Editing (brightness, contrast, cropping)"}, {"content": "Color Correction and Enhancement"}, {"content": "Using filters and presets"}], "status": "false"}',
      },
      {
        text: `input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\n${info}\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify  technologies or skills they need to learn\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nUsers will often learn on their own, so they will often learn using videos or online resources and without instructors.\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing next information and don\'t duplicate information in User Input. If in User Input there is no information related to the skills the user already has related to the goal, ask a question about it.\nexampleAnswer should be diverse and relevant to the question, including popular frameworks and underlying technologies.(3 example answers)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation(if enough return true, if not return false), if User input have 6 line status return true.`,
      },
      { text: 'output: ' },
    ];
    const result = await this.model.generateContent({
      contents: [{ role: 'user', parts }],
      generationConfig: this.generationConfig,
    });
    const res = await result.response.text();
    const resJson = await JSON.parse(res);

    console.log(resJson);
    return resJson;
  }

  async generateQuestion2(info: string) {
    console.log(info);
    const parts = [
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals: Study AWS\nGoal: AWS Solutions Architect Associate certification\nExperience Level: Beginner\n\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify the most specific technologies or skills they need to learn.\nanswer: A placeholder for the user\'s answer to the question.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nIf user input have 6 row\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing more specific information.\nThe exampleAnswer should be diverse and relevant to AWS, covering both popular frameworks and fundamental technologies.(3 exampleAnswer)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation.',
      },
      {
        text: 'output: {"nextQuestion": "What specific AWS services are you most interested in learning about or working with?","answer": "Services: ", "exampleAnswer": [{"content": "EC2 (Elastic Compute Cloud)"}, {"content": "S3 (Simple Storage Service)"}, {"content": "Lambda (Serverless Computing)"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals:  Play piano\nExperience Level: Beginner\nStyle: Romantic\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify the most specific technologies or skills they need to learn.\nanswer: A placeholder for the user\'s answer to the question.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing more specific information.\nThe exampleAnswer should be diverse and relevant to AWS, covering both popular frameworks and fundamental technologies.(3 exampleAnswer)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation.',
      },
      {
        text: 'output: {"nextQuestion": "What specific pieces of classical music do you enjoy or are interested in learning?","answer": "Music: ", "exampleAnswer": [{"content": "Mozart Sonatas"}, {"content": "Bach Preludes and Fugues"}, {"content": "Beethoven Piano Concertos"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals:  Study desgin\nType: Graphic Design\nSpecific: Logo design\n\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify the most specific technologies or skills they need to learn.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing more specific information.\nThe exampleAnswer should be diverse and relevant to AWS, covering both popular frameworks and fundamental technologies.(3 exampleAnswer)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation.',
      },
      {
        text: 'output: {"nextQuestion": "What specific software or tools are you interested in learning for logo design?", "answer": "Software: ", "exampleAnswer": [{"content": "Adobe Illustrator"}, {"content": "Canva"}, {"content": "Figma"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals:  Learn programming\nLanguage: Python\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify the most specific technologies or skills they need to learn.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing more specific information.\nThe exampleAnswer should be diverse and relevant to AWS, covering both popular frameworks and fundamental technologies.(3 exampleAnswer)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation.',
      },
      {
        text: 'output: {"nextQuestion": "What specific areas or applications of Python are you most interested in?", "answer": "Areas: ", "exampleAnswer": [{"content": "Data Science and Machine Learning"}, {"content": "Web Development"}, {"content": "Automation and Scripting"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals: Learn communication\nSpecific: Public Speaking \n\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify the most specific technologies or skills they need to learn.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing more specific information.\nThe exampleAnswer should be diverse and relevant to AWS, covering both popular frameworks and fundamental technologies.(3 exampleAnswer)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation.',
      },
      {
        text: 'output: {"nextQuestion": "What specific types of public speaking are you interested in or do you need to develop skills for?", "answer": "Type: ", "exampleAnswer": [{"content": "Presentations at work"}, {"content": "Public speeches"}, {"content": "Toastmastering"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals:  Learn painting \nStyle: Acrylic\n\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify the most specific technologies or skills they need to learn.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing more specific information.\nThe exampleAnswer should be diverse and relevant to AWS, covering both popular frameworks and fundamental technologies.(3 exampleAnswer)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation.',
      },
      {
        text: 'output: {"nextQuestion": "What specific subjects or types of acrylic painting are you interested in exploring?", "answer": "Subjects: ", "exampleAnswer": [{"content": "Landscapes"}, {"content": "Portraits"}, {"content": "Abstract Art"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals:  Learn content creation\nInterested: Blog post\nTopic: Food\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify the most specific technologies or skills they need to learn.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing more specific information.\nThe exampleAnswer should be diverse and relevant to AWS, covering both popular frameworks and fundamental technologies.(3 exampleAnswer)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation.',
      },
      {
        text: 'output: {"nextQuestion": "What specific type of food blog are you interested in creating?", "answer": "Food Type: ", "exampleAnswer": [{"content": "Recipes"}, {"content": "Restaurant Reviews"}, {"content": "Food Photography and Styling"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals: Learn French \nLevel: Basic knowledge\nGoal: Basic communicate\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify the most specific technologies or skills they need to learn.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing more specific information.\nThe exampleAnswer should be diverse and relevant to AWS, covering both popular frameworks and fundamental technologies.(3 exampleAnswer)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation.',
      },
      {
        text: 'output: {"nextQuestion": "What are your specific communication goals in French? (e.g., travel, work, social interaction)", "answer": "Goals: ", "exampleAnswer": [{"content": "Traveling to France"}, {"content": "Working in a French-speaking environment"}, {"content": "Socializing with French speakers"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals:  Learn how to tip beautiful photos\nTools: Iphone \n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify the most specific technologies or skills they need to learn.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing more specific information.\nThe exampleAnswer should be diverse and relevant to AWS, covering both popular frameworks and fundamental technologies.(3 exampleAnswer)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation.\nLet me know if you have any other questions or need further assistance.',
      },
      {
        text: 'output: {"nextQuestion": "What specific aspects of photo editing are you most interested in learning for your iPhone?", "answer": "Aspects: ", "exampleAnswer": [{"content": "Basic Editing (brightness, contrast, cropping)"}, {"content": "Color Correction and Enhancement"}, {"content": "Using filters and presets"}], "status": "false"}',
      },
      {
        text: `input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\n${info}\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify the most specific technologies or skills they need to learn.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing more specific information.\nThe exampleAnswer should be diverse and relevant to AWS, covering both popular frameworks and fundamental technologies.(3 exampleAnswer)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation.\nLet me know if you have any other questions or need further assistance.`,
      },
      { text: 'output: ' },
    ];

    const result = await this.model.generateContent({
      contents: [{ role: 'user', parts }],
      generationConfig: this.generationConfig,
      // safetySettings: Adjust safety settings
      // See https://ai.google.dev/gemini-api/docs/safety-settings
    });

    const res = await result.response.text();
    const resJson = await JSON.parse(res);
    console.log(resJson);

    return resJson;
  }

  async generateQuestion3(info: string) {
    const parts = [
      {
        text: 'input: Generate next question and answer is keyword  relate to content and 3 examples content:\nPersonal or Career Goals:  Study AWS\nCurrent Skill Level: Beginner\nInterest: DevOps',
      },
      {
        text: 'output: {\n"nextQuestion": "What is your preferred learning style?",\n"answer":"Interest: ",\n"exampleAnswer": [\n{"content":"Reading"},\n{"content":"Online courses"},\n{"content":"Hands-on labs"},\n]\n}',
      },
      {
        text: 'input: Generate next question and answer is keyword  relate to content and 3 examples content:\nPersonal or Career Goals: Front-end Developer\nInterest: React\nExperience Level: Beginner',
      },
      {
        text: 'output: {\n"nextQuestion": "What is your preferred learning style?",\n"answer":"Interest: ",\n"exampleAnswer": [\n{"content":"Reading"},\n{"content":"Online courses"},\n{"content":"Hands-on labs"},\n]\n}',
      },
      {
        text: "input: Generate next question and answer is keyword  relate to content and 3 examples content:\nPersonal or Career Goals: Piano\nKnowledge: I don't have any knowledge about music\nGoals: Learn basic chords and melodies",
      },
      {
        text: 'output: {"nextQuestion": "What is your preferred learning style?", "answer":"Interest: ", "exampleAnswer": [{"content":"Video"}, {"content":"Online courses"}, {"content":"Practice"}]}',
      },
      {
        text: 'input: Generate next question and answer is keyword  relate to content and 3 examples content:\nPersonal or Career Goals: Guitar\nGuitar Type: Acoustic\nExperience Level: Intermediate',
      },
      {
        text: 'output: {"nextQuestion": "What is your preferred learning style?", "answer":"Interest: ", "exampleAnswer": [{"content":"Video"}, {"content":"Online courses"}, {"content":"Practice"}]}',
      },
      {
        text: `input: Generate next question and answer is keyword  relate to content and 3 examples content: \n${info}`,
      },
      { text: 'output: ' },
    ];

    const result = await this.model.generateContent({
      contents: [{ role: 'user', parts }],
      generationConfig: this.generationConfig,
      // safetySettings: Adjust safety settings
      // See https://ai.google.dev/gemini-api/docs/safety-settings
    });

    const res = await result.response.text();
    const resJson = await JSON.parse(res);
    console.log(resJson);

    return resJson;
  }

  async generateRoadmap(user: User, info: string, title: string) {
    const parts = [
      {
        text: 'input: You are an AI assistant helping a university student create a personalized roadmap to AWS\n\nGiven the following user information and goals, generate a detailed roadmap in JSON format.\n\n**User Information:**\n\n- Age: 20\n- Gender: Male\n- Location: Ha Noi\n- Occupation: Student\n\n**Goals and Expectations:**\n\nPersonal or Career Goals:  Study AWS\nCurrent Skill Level: Beginner\nInterest: DevOps\nInterest: Online Course\n\n\n**Roadmap Structure:**\n\nThe roadmap should be structured as follows:\n\n* **Stages:** Each stage represents a major phase in the learning journey.\n    * **Name:** A descriptive name for the stage.\n    * **Timeframe:** Estimated duration of the stage (e.g., "3 months").\n    * **Tasks:** A list of tasks to be completed within the stage.\n* **Tasks:** Each task represents a specific learning objective.\n    * **Name:** A clear and concise name for the task.\n    * **Description:** A detailed explanation of what the task entails.\n    * **Time:** Estimated time required to complete the task.\n    * **Subtasks:** A list of smaller, actionable steps to achieve the task.\n* **Subtasks:**\n    * **Name:** A descriptive name for the subtask.\n    * **Description:** A brief explanation of the subtask.\n    * **Resources:** Links to relevant learning resources, require resource links must be usable and must not appear 404 errors (e.g., online courses, tutorials, documentation)\n    * **Time:** Estimated time required to complete the subtask.\n    * **Quiz:** Empty array \n\n**Example JSON Structure:**\n\n{\n  "Roadmap": {\n    "Stages": [\n      {\n        "Name": "Stage 1 Name",\n        "Timeframe": "3 months",\n        "Tasks": [\n          {\n            "Name": "Task 1 Name",\n            "Description": "Task 1 Description",\n            "Time": "1 month",\n            "Subtasks": [\n              {\n                "Name": "Subtask 1 Name",\n                "Description": "Subtask 1 Description",\n                "Resources": ["Resource 1 Link", "Resource 2 Link", "Resource 3 Link", {... more resources}\n],\n                "Time": "1 week",\n                "Quiz": []\n              },\n              // ... more subtasks(minimum 4 subtasks)\n            ]\n          },\n          // ... more tasks(minimum 3 tasks)\n        ]\n      },\n      // ... more stages(minimum 2 stages)\n    ]\n  }\n}\n\n**Important Notes:**\n\n* Tailor the roadmap to the user\'s age, location, occupation, and specific goals.\n* Provide realistic timeframes and suggest relevant resources for each subtask.\n* Ensure the JSON output is well-formatted and easy to read.',
      },
      {
        text: 'output: {"Roadmap": {"Stages": [{"Name": "AWS Fundamentals", "Timeframe": "2 months", "Tasks": [{"Name": "AWS Concepts and Services", "Description": "Gain a foundational understanding of AWS core concepts, key services, and the AWS cloud architecture.", "Time": "1 month", "Subtasks": [{"Name": "Introduction to AWS", "Description": "Learn about the history, benefits, and use cases of AWS.", "Resources": ["https://aws.amazon.com/what-is-aws/", "https://www.youtube.com/watch?v=Y-d3cV4T64c"], "Time": "1 week", "Quiz": []}, {"Name": "AWS Global Infrastructure", "Description": "Explore the AWS global infrastructure, regions, and availability zones.", "Resources": ["https://aws.amazon.com/about-aws/global-infrastructure/"], "Time": "1 week", "Quiz": []}, {"Name": "Compute Services (EC2, Lambda)", "Description": "Understand the different types of compute services available on AWS, including EC2 and Lambda.", "Resources": ["https://aws.amazon.com/ec2/", "https://aws.amazon.com/lambda/"], "Time": "1 week", "Quiz": []}, {"Name": "Storage Services (S3, EBS)", "Description": "Learn about AWS storage options, including S3 for object storage and EBS for block storage.", "Resources": ["https://aws.amazon.com/s3/", "https://aws.amazon.com/ebs/"], "Time": "1 week", "Quiz": []}, {"Name": "Networking Services (VPC, Route 53)", "Description": "Explore the AWS networking model, including VPCs, subnets, and Route 53 for DNS.", "Resources": ["https://aws.amazon.com/vpc/", "https://aws.amazon.com/route-53/"], "Time": "1 week", "Quiz": []}]}, {"Name": "Hands-on Practice with AWS", "Description": "Apply your knowledge by working through practical exercises and building simple AWS projects.", "Time": "1 month", "Subtasks": [{"Name": "Create an AWS Account", "Description": "Sign up for a free AWS account and familiarize yourself with the AWS Management Console.", "Resources": ["https://aws.amazon.com/free/"], "Time": "1 week", "Quiz": []}, {"Name": "Launch an EC2 Instance", "Description": "Learn how to launch and configure a virtual machine (EC2 instance) on AWS.", "Resources": ["https://aws.amazon.com/getting-started/tutorials/launch-an-ec2-instance/"], "Time": "1 week", "Quiz": []}, {"Name": "Deploy a Simple Web Application", "Description": "Build a basic web application using AWS services and deploy it to AWS.", "Resources": ["https://aws.amazon.com/getting-started/tutorials/deploy-a-web-application/"], "Time": "2 weeks", "Quiz": []}, {"Name": "Explore AWS Console and CLI", "Description": "Gain proficiency in using the AWS Management Console and the AWS Command Line Interface (CLI).", "Resources": ["https://aws.amazon.com/console/", "https://aws.amazon.com/cli/"], "Time": "1 week", "Quiz": []}]}]}, {"Name": "DevOps with AWS", "Timeframe": "3 months", "Tasks": [{"Name": "Infrastructure as Code (IaC)", "Description": "Learn about Infrastructure as Code (IaC) and its benefits. Master tools like CloudFormation and Terraform for automated infrastructure provisioning.", "Time": "1.5 months", "Subtasks": [{"Name": "Introduction to IaC", "Description": "Understand the principles of Infrastructure as Code (IaC) and its advantages.", "Resources": ["https://aws.amazon.com/solutions/infrastructure-as-code/"], "Time": "1 week", "Quiz": []}, {"Name": "AWS CloudFormation", "Description": "Learn how to use AWS CloudFormation to define and manage your AWS resources using templates.", "Resources": ["https://aws.amazon.com/cloudformation/"], "Time": "3 weeks", "Quiz": []}, {"Name": "Terraform for AWS", "Description": "Explore Terraform, an open-source tool, to manage AWS infrastructure using declarative configuration.", "Resources": ["https://www.terraform.io/docs/providers/aws/index.html"], "Time": "3 weeks", "Quiz": []}, {"Name": "Practical IaC Projects", "Description": "Build real-world IaC projects using either CloudFormation or Terraform.", "Resources": ["https://github.com/hashicorp/terraform-aws-examples"], "Time": "2 weeks", "Quiz": []}]}, {"Name": "CI/CD Pipelines with AWS", "Description": "Learn to create Continuous Integration/Continuous Deployment (CI/CD) pipelines using AWS services like CodePipeline and CodeBuild.", "Time": "1 month", "Subtasks": [{"Name": "AWS CodePipeline", "Description": "Learn about AWS CodePipeline and its role in automating the release process.", "Resources": ["https://aws.amazon.com/codepipeline/"], "Time": "2 weeks", "Quiz": []}, {"Name": "AWS CodeBuild", "Description": "Understand how AWS CodeBuild works to build, test, and package your applications.", "Resources": ["https://aws.amazon.com/codebuild/"], "Time": "2 weeks", "Quiz": []}, {"Name": "Building CI/CD Pipelines", "Description": "Practice creating CI/CD pipelines using AWS CodePipeline and CodeBuild.", "Resources": ["https://aws.amazon.com/getting-started/tutorials/build-a-ci-cd-pipeline/"], "Time": "2 weeks", "Quiz": []}, {"Name": "Implementing CI/CD best practices", "Description": "Learn about best practices for designing and implementing efficient and secure CI/CD pipelines.", "Resources": ["https://aws.amazon.com/blogs/devops/best-practices-for-building-continuous-delivery-pipelines-on-aws/"], "Time": "1 week", "Quiz": []}]}, {"Name": "Monitoring and Logging", "Description": "Learn how to monitor and log your AWS applications and infrastructure using services like CloudWatch and CloudTrail.", "Time": "0.5 months", "Subtasks": [{"Name": "AWS CloudWatch", "Description": "Explore AWS CloudWatch for monitoring your applications and infrastructure.", "Resources": ["https://aws.amazon.com/cloudwatch/"], "Time": "2 weeks", "Quiz": []}, {"Name": "AWS CloudTrail", "Description": "Understand how to use CloudTrail to audit and track activity in your AWS environment.", "Resources": ["https://aws.amazon.com/cloudtrail/"], "Time": "1 week", "Quiz": []}, {"Name": "Setting up Monitoring and Logging", "Description": "Configure CloudWatch and CloudTrail to monitor and log your AWS resources.", "Resources": ["https://aws.amazon.com/getting-started/tutorials/monitor-your-applications/"], "Time": "2 weeks", "Quiz": []}]}]}]}}',
      },
      {
        text: 'input: You are an AI assistant helping a university student create a personalized roadmap \n\nGiven the following user information and goals, generate a detailed roadmap in JSON format.\n\n**User Information:**\n\n- Age: 20\n- Gender: Male\n- Location: Ha Noi\n- Occupation: Student\n\n**Goals and Expectations:**\n\nPersonal or Career Goals: Play guitar \nExperience:  Beginner \nGuitar Type:  Acoustic Guitar \nGenre:  Classical \nPieces:  Classical Guitar Standards \nPieces/Composers:  Fernando Sor \nSkills:  Fingerstyle Techniques \nTechniques:  Arpeggios\n\n**Roadmap Structure:**\n\nThe roadmap should be structured as follows:\n\n* **Stages:** Each stage represents a major phase in the learning journey.\n    * **Name:** A descriptive name for the stage.\n    * **Timeframe:** Estimated duration of the stage (e.g., "3 months").\n    * **Tasks:** A list of tasks to be completed within the stage.\n* **Tasks:** Each task represents a specific learning objective.\n    * **Name:** A clear and concise name for the task.\n    * **Description:** A detailed explanation of what the task entails.\n    * **Time:** Estimated time required to complete the task.\n    * **Subtasks:** A list of smaller, actionable steps to achieve the task.\n* **Subtasks:**\n    * **Name:** A descriptive name for the subtask.\n    * **Description:** A brief explanation of the subtask.\n    * **Resources:** Links to relevant learning resources, require resource links must be usable and must not appear 404 errors (e.g., online courses, tutorials, documentation)\n    * **Time:** Estimated time required to complete the subtask.\n    * **Quiz:** Empty array \n\n**Example JSON Structure:**\n\n{\n  "Roadmap": {\n    "Stages": [\n      {\n        "Name": "Stage 1 Name",\n        "Timeframe": "3 months",\n        "Tasks": [\n          {\n            "Name": "Task 1 Name",\n            "Description": "Task 1 Description",\n            "Time": "1 month",\n            "Subtasks": [\n              {\n                "Name": "Subtask 1 Name",\n                "Description": "Subtask 1 Description",\n                "Resources": ["Resource 1 Link", "Resource 2 Link", "Resource 3 Link", {... more resources}\n],\n                "Time": "1 week",\n                "Quiz": []\n              },\n              // ... more subtasks(minimum 4 subtasks)\n            ]\n          },\n          // ... more tasks(minimum 3 tasks)\n        ]\n      },\n      // ... more stages(minimum 2 stages)\n    ]\n  }\n}\n\n**Important Notes:**\n\n* Tailor the roadmap to the user\'s age, location, occupation, and specific goals.\n* Provide realistic timeframes and suggest relevant resources for each subtask.\n* Ensure the JSON output is well-formatted and easy to read.',
      },
      {
        text: 'output: {"Roadmap": {"Stages": [{"Name": "Fundamentals of Classical Guitar", "Timeframe": "3 months", "Tasks": [{"Name": "Basic Posture and Hand Position", "Description": "Learn the correct posture and hand positioning for classical guitar playing.", "Time": "1 month", "Subtasks": [{"Name": "Proper Posture", "Description": "Understand the importance of good posture for playing the guitar comfortably and efficiently.", "Resources": ["https://www.youtube.com/watch?v=k_24oW644aY", "https://www.classicalguitar.com/articles/posture/"], "Time": "1 week", "Quiz": []}, {"Name": "Left-Hand Positioning", "Description": "Master the correct placement and technique for your left hand on the fretboard.", "Resources": ["https://www.youtube.com/watch?v=2D64M_499kE", "https://www.classicalguitar.com/articles/left-hand-technique/"], "Time": "2 weeks", "Quiz": []}, {"Name": "Right-Hand Technique", "Description": "Develop proper right-hand technique for plucking the strings with your fingers.", "Resources": ["https://www.youtube.com/watch?v=Z6G71-2p_vU", "https://www.classicalguitar.com/articles/right-hand-technique/"], "Time": "2 weeks", "Quiz": []}, {"Name": "Basic Chords and Scales", "Description": "Learn fundamental chords and scales used in classical guitar music.", "Resources": ["https://www.youtube.com/watch?v=8fU3R0l_uY8", "https://www.classicalguitar.com/articles/chords-and-scales/"], "Time": "1 week", "Quiz": []}]}, {"Name": "Fingerstyle Techniques", "Description": "Develop fingerstyle techniques for playing classical guitar pieces.", "Time": "1 month", "Subtasks": [{"Name": "Arpeggios", "Description": "Practice playing arpeggios, a fundamental technique in classical guitar.", "Resources": ["https://www.youtube.com/watch?v=0f5u_16D4sQ", "https://www.classicalguitar.com/articles/arpeggios/"], "Time": "2 weeks", "Quiz": []}, {"Name": "Strumming Patterns", "Description": "Learn various strumming patterns used in classical guitar music.", "Resources": ["https://www.youtube.com/watch?v=j8uZ97c5Z_c", "https://www.classicalguitar.com/articles/strumming-patterns/"], "Time": "2 weeks", "Quiz": []}, {"Name": "Fingerpicking Techniques", "Description": "Master fingerpicking techniques, including alternate picking and rest strokes.", "Resources": ["https://www.youtube.com/watch?v=9V_w25-f-v8", "https://www.classicalguitar.com/articles/fingerpicking/"], "Time": "2 weeks", "Quiz": []}, {"Name": "Classical Guitar Notation", "Description": "Learn to read and understand classical guitar notation.", "Resources": ["https://www.youtube.com/watch?v=Q_v4W7D_97Y", "https://www.classicalguitar.com/articles/notation/"], "Time": "1 week", "Quiz": []}]}, {"Name": "Fernando Sor Etudes and Pieces", "Description": "Learn and practice selected etudes and pieces by Fernando Sor, a renowned classical guitar composer.", "Time": "1 month", "Subtasks": [{"Name": "Study Sor\'s Biography and Style", "Description": "Learn about Fernando Sor\'s life, musical style, and influence on classical guitar.", "Resources": ["https://en.wikipedia.org/wiki/Fernando_Sor", "https://www.classicalguitar.com/composers/sor/"], "Time": "1 week", "Quiz": []}, {"Name": "Practice Sor\'s Etudes", "Description": "Work through Sor\'s etudes, focusing on technique and musicality.", "Resources": ["https://imslp.org/wiki/Category:Sor%2C_Fernando", "https://www.youtube.com/watch?v=lC_2y84k-1g"], "Time": "2 weeks", "Quiz": []}, {"Name": "Learn and Perform Sor\'s Pieces", "Description": "Choose and learn several of Sor\'s pieces to perform.", "Resources": ["https://imslp.org/wiki/Category:Sor%2C_Fernando", "https://www.youtube.com/watch?v=c-t1-k4w11A"], "Time": "2 weeks", "Quiz": []}, {"Name": "Record and Analyze Your Performances", "Description": "Record your performances of Sor\'s pieces and analyze your playing to identify areas for improvement.", "Resources": ["https://www.youtube.com/watch?v=u_3Y30-9Z4w", "https://www.classicalguitar.com/articles/recording-and-analysis/"], "Time": "1 week", "Quiz": []}]}]}, {"Name": "Intermediate Classical Guitar", "Timeframe": "3 months", "Tasks": [{"Name": "Advanced Fingerstyle Techniques", "Description": "Master more advanced fingerstyle techniques, including tremolo, rasgueado, and harmonics.", "Time": "1 month", "Subtasks": [{"Name": "Tremolo Technique", "Description": "Learn the tremolo technique, which involves rapidly alternating two fingers to create a sustained sound.", "Resources": ["https://www.youtube.com/watch?v=l_859Y-7o4M", "https://www.classicalguitar.com/articles/tremolo/"], "Time": "2 weeks", "Quiz": []}, {"Name": "Rasgueado Technique", "Description": "Practice the rasgueado technique, which involves using the thumb and fingers to create a strumming effect.", "Resources": ["https://www.youtube.com/watch?v=W3y_5F_P774", "https://www.classicalguitar.com/articles/rasgueado/"], "Time": "2 weeks", "Quiz": []}, {"Name": "Harmonics", "Description": "Learn to produce harmonics on the classical guitar, adding a unique and ethereal sound to your playing.", "Resources": ["https://www.youtube.com/watch?v=w6V-v2Z-z3M", "https://www.classicalguitar.com/articles/harmonics/"], "Time": "2 weeks", "Quiz": []}, {"Name": "Advanced Chord Voicings", "Description": "Explore more complex and sophisticated chord voicings for classical guitar.", "Resources": ["https://www.youtube.com/watch?v=6_v-v4-v-v4", "https://www.classicalguitar.com/articles/chord-voicings/"], "Time": "1 week", "Quiz": []}]}, {"Name": "Classical Guitar Repertoire", "Description": "Expand your repertoire by learning pieces from different periods and styles of classical guitar music.", "Time": "1 month", "Subtasks": [{"Name": "Baroque Era Pieces", "Description": "Learn pieces from the Baroque era, such as works by Bach, Vivaldi, and Scarlatti.", "Resources": ["https://www.classicalguitar.com/composers/bach/", "https://www.classicalguitar.com/composers/vivaldi/", "https://www.classicalguitar.com/composers/scarlatti/"], "Time": "2 weeks", "Quiz": []}, {"Name": "Classical Era Pieces", "Description": "Explore pieces from the Classical era, including works by Mozart, Haydn, and Beethoven.", "Resources": ["https://www.classicalguitar.com/composers/mozart/", "https://www.classicalguitar.com/composers/haydn/", "https://www.classicalguitar.com/composers/beethoven/"], "Time": "2 weeks", "Quiz": []}, {"Name": "Romantic Era Pieces", "Description": "Learn pieces from the Romantic era, such as works by Chopin, Schumann, and Liszt.", "Resources": ["https://www.classicalguitar.com/composers/chopin/", "https://www.classicalguitar.com/composers/schumann/", "https://www.classicalguitar.com/composers/liszt/"], "Time": "2 weeks", "Quiz": []}, {"Name": "Modern Classical Guitar Pieces", "Description": "Explore contemporary classical guitar pieces by composers like Leo Brouwer, Roland Dyens, and Benjamin Britten.", "Resources": ["https://www.classicalguitar.com/composers/brouwer/", "https://www.classicalguitar.com/composers/dyens/", "https://www.classicalguitar.com/composers/britten/"], "Time": "1 week", "Quiz": []}]}, {"Name": "Performance and Improvisation", "Description": "Develop your performance skills and explore improvisation within the classical guitar context.", "Time": "1 month", "Subtasks": [{"Name": "Stage Presence and Performance Techniques", "Description": "Learn techniques for performing confidently and engagingly on stage.", "Resources": ["https://www.youtube.com/watch?v=y_v-v-v-v-v", "https://www.classicalguitar.com/articles/performance/"], "Time": "2 weeks", "Quiz": []}, {"Name": "Improvisation Techniques", "Description": "Explore improvisation techniques within the classical guitar framework.", "Resources": ["https://www.youtube.com/watch?v=v-v-v-v-v-v", "https://www.classicalguitar.com/articles/improvisation/"], "Time": "2 weeks", "Quiz": []}, {"Name": "Performing for an Audience", "Description": "Practice performing your repertoire for an audience, whether friends, family, or a small group.", "Resources": ["https://www.youtube.com/watch?v=v-v-v-v-v-v", "https://www.classicalguitar.com/articles/performance-tips/"], "Time": "2 weeks", "Quiz": []}, {"Name": "Recording and Feedback", "Description": "Record your performances and seek feedback from experienced guitarists or teachers to identify areas for improvement.", "Resources": ["https://www.youtube.com/watch?v=v-v-v-v-v-v", "https://www.classicalguitar.com/articles/feedback/"], "Time": "1 week", "Quiz": []}]}]}]}}',
      },
      {
        text: `input: You are an AI assistant helping a university student create a personalized roadmap .\n\nGiven the following user information and goals, generate a detailed roadmap in JSON format.\n\n**User Information:**\n\n- Age: ${user.age}\n- Gender: ${user.gender}\n- Location: ${user.location}\n- Occupation: ${user.occupation}\n\n**Goals and Expectations:**\n\n${info}\n\n\n**Roadmap Structure:**\n\nThe roadmap should be structured as follows:\n\n* **Stages:** Each stage represents a major phase in the learning journey.\n    * **Name:** A descriptive name for the stage.\n    * **Timeframe:** Estimated duration of the stage (e.g., "3 months").\n    * **Tasks:** A list of tasks to be completed within the stage.\n* **Tasks:** Each task represents a specific learning objective.\n    * **Name:** A clear and concise name for the task.\n    * **Description:** A detailed explanation of what the task entails.\n    * **Time:** Estimated time required to complete the task.\n    * **Subtasks:** A list of smaller, actionable steps to achieve the task.\n* **Subtasks:**\n    * **Name:** A descriptive name for the subtask.\n    * **Description:** A brief explanation of the subtask.\n    * **Resources:** Links to relevant learning resources, require resource links must be usable and must not appear 404 errors (e.g., online courses, tutorials, documentation)\n    * **Time:** Estimated time required to complete the subtask.\n    * **Quiz:** Empty array \n\n**Example JSON Structure:**\n\n{\n  "Roadmap": {\n    "Stages": [\n      {\n        "Name": "Stage 1 Name",\n        "Timeframe": "3 months",\n        "Tasks": [\n          {\n            "Name": "Task 1 Name",\n            "Description": "Task 1 Description",\n            "Time": "1 month",\n            "Subtasks": [\n              {\n                "Name": "Subtask 1 Name",\n                "Description": "Subtask 1 Description",\n                "Resources": ["Resource 1 Link", "Resource 2 Link", "Resource 3 Link", {... more resources}\n],\n                "Time": "1 week",\n                "Quiz": []\n              },\n              // ... more subtasks(minimum 4 subtasks)\n            ]\n          },\n          // ... more tasks(minimum 3 tasks)\n        ]\n      },\n      // ... more stages(minimum 2 stages)\n    ]\n  }\n}\n\n**Important Notes:**\n\n* Tailor the roadmap to the user\'s age, location, occupation, and specific goals.\n* Provide realistic timeframes and suggest relevant resources for each subtask.\n* Ensure the JSON output is well-formatted and easy to read.`,
      },
      { text: 'output: ' },
    ];
    const result = await this.model.generateContent({
      contents: [{ role: 'user', parts }],
      generationConfig: {
        ...this.generationConfig,
        maxOutputTokens: 10000,
        temperature: 0.4,
      },
      // safetySettings: Adjust safety settings
      // See https://ai.google.dev/gemini-api/docs/safety-settings
    });

    const res = result.response.text();
    // const jsonString = await this.createJsonString(res);
    // console.log(jsonString);
    console.log(info);
    const resJson = await JSON.parse(res);

    console.log(resJson);

    const roadmap = await this.prismaService.roadmap.create({
      data: {
        userId: user.id,
        title,
        stages: resJson.Roadmap.Stages,
      },
    });

    return roadmap;
  }

  async getRoadmap(id: string) {
    const roadmap = await this.prismaService.roadmap.findUnique({
      where: {
        id,
      },
    });

    return roadmap;
  }

  async createJsonString(data: string) {
    return JSON.stringify(data);
  }

  async generateQuiz(generateQuizDto: GenerateQuizDto) {
    const parts = [
      {
        text: 'input: Requirements:\n   - Generate an array of 5-10 multiple-choice questions.\n   - Each question must have 4 answer options.\n   - Only one option is correct.\n   - The content of the questions and answer options must be related to the topic provided in the input.\n   - Use information from "Description" and "Resources" to create accurate and relevant questions.\nNotes:\n   - You can use natural language processing (NLP) techniques to analyze "Description" and "Resources" and generate high-quality questions.\n   -You can also use large language models (LLMs) to assist in creating questions and answer options.\n\nOutput Structure:\n[\n  {\n    "Question": "Question 1",\n    "Options": ["Option A", "Option B", "Option C", "Option D"],\n    "Answer": "Correct Option"\n  },\n  {\n    "Question": "Question 2",\n    "Options": ["Option A", "Option B", "Option C", "Option D"],\n    "Answer": "Correct Option"\n  },\n  // ... (3-8 other questions)\n]\n\n\nInput:\nName : AWS Global Infrastructure\nDescription: Explore the AWS global infrastructure, regions, and availability zones.\nResources: ["https://aws.amazon.com/about-aws/global-infrastructure/"]',
      },
      {
        text: 'output: [{"Question": "What is the purpose of Availability Zones within the AWS Global Infrastructure?", "Options": ["To provide redundancy and fault tolerance across multiple geographic locations.", "To offer lower latency for users in specific regions.", "To provide access to specialized AWS services within a region.", "To ensure data sovereignty compliance within specific countries."], "Answer": "To provide redundancy and fault tolerance across multiple geographic locations."}, {"Question": "Which of the following is NOT a benefit of using AWS Global Infrastructure?", "Options": ["Reduced latency for users.", "Enhanced security and compliance.", "Lower cost for data storage and processing.", "Increased dependence on a single vendor."], "Answer": "Increased dependence on a single vendor."}, {"Question": "What is the difference between an AWS Region and an Availability Zone?", "Options": ["A region is a geographic location, while an Availability Zone is a data center within a region.", "An Availability Zone is a geographic location, while a region is a data center within an Availability Zone.", "A region is a group of data centers, while an Availability Zone is a specific server within a data center.", "There is no difference between an AWS Region and an Availability Zone."], "Answer": "A region is a geographic location, while an Availability Zone is a data center within a region."}, {"Question": "Which AWS service provides a fully managed, scalable, and secure infrastructure for running applications in the cloud?", "Options": ["Amazon EC2", "Amazon S3", "Amazon RDS", "Amazon CloudFront"], "Answer": "Amazon EC2"}, {"Question": "How many Availability Zones are typically present within an AWS Region?", "Options": ["1", "2", "3", "At least 2, but can vary by region."], "Answer": "At least 2, but can vary by region."}]',
      },
      {
        text: `input: Requirements:\n   - Generate an array of 5-10 multiple-choice questions.\n   - Each question must have 4 answer options.\n   - Only one option is correct.\n   - The content of the questions and answer options must be related to the topic provided in the input.\n   - Use information from "Description" and "Resources" to create accurate and relevant questions.\nNotes:\n   - You can use natural language processing (NLP) techniques to analyze "Description" and "Resources" and generate high-quality questions.\n   -You can also use large language models (LLMs) to assist in creating questions and answer options.\n\nOutput Structure:\n[\n  {\n    "Question": "Question 1",\n    "Options": ["Option A", "Option B", "Option C", "Option D"],\n    "Answer": "Correct Option"\n  },\n  {\n    "Question": "Question 2",\n    "Options": ["Option A", "Option B", "Option C", "Option D"],\n    "Answer": "Correct Option"\n  },\n  // ... (3-8 other questions)\n]\n\n\nInput:\nName : ${generateQuizDto.Name}\nDescription: ${generateQuizDto.Description}\nResources: ${generateQuizDto.Resources}`,
      },
      { text: 'output: ' },
    ];

    const result = await this.model.generateContent({
      contents: [{ role: 'user', parts }],
      generationConfig: {
        ...this.generationConfig,
        maxOutputTokens: 10000,
        temperature: 0.4,
      },
      // safetySettings: Adjust safety settings
      // See https://ai.google.dev/gemini-api/docs/safety-settings
    });

    const res = result.response.text();
    // const jsonString = await this.createJsonString(res);
    // console.log(jsonString);
    console.log(generateQuizDto);
    const resJson = await JSON.parse(res);

    console.log(resJson);
  }
}
