import { Injectable } from '@nestjs/common';
import { ConfigService } from '@nestjs/config';
import { GoogleGenerativeAI } from '@google/generative-ai';
import { PrismaService } from 'src/prisma/prisma.service';
import { User } from '@prisma/client';

@Injectable()
export class GeminiService {
  private genAI: any;
  private model: any;
  private generationConfig: any;

  constructor(
    private readonly configService: ConfigService,
    private readonly prismaService: PrismaService,
  ) {
    this.genAI = new GoogleGenerativeAI(configService.get('GOOGLE_API_KEY'));

    this.model = this.genAI.getGenerativeModel({ model: 'gemini-1.5-flash' });

    this.generationConfig = {
      temperature: 0.65,
      topP: 0.95,
      topK: 64,
      maxOutputTokens: 800,
      responseMimeType: 'application/json',
    };
  }

  async generateQuestion1(info: string) {
    const parts = [
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\n\nUser Input:\nPersonal or Career Goals: Study AWS\nGoal: AWS Solutions Architect Associate certification\nExperience Level: Beginner\n\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify  technologies or skills they need to learn\nanswer: A placeholder for the user\'s answer to the question.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nUsers will often learn on their own, so they will often learn using videos or online resources and without instructors.\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing next information and don\'t duplicate information in User Input. If in User Input there is no information related to the skills the user already has related to the goal, ask a question about it.\nexampleAnswer should be diverse and relevant to the question, including popular frameworks and underlying technologies.(3 example answers)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation(if enough return true, if not return false), if User input have 6 line return true.',
      },
      {
        text: 'output: {"nextQuestion": "What specific AWS services are you most interested in learning about or working with?","answer": "Services: ", "exampleAnswer": [{"content": "EC2 (Elastic Compute Cloud)"}, {"content": "S3 (Simple Storage Service)"}, {"content": "Lambda (Serverless Computing)"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals:  Play piano\nExperience Level: Beginner\nStyle: Romantic\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify  technologies or skills they need to learn.\nanswer: A placeholder for the user\'s answer to the question.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nUsers will often learn on their own, so they will often learn using videos or online resources and without instructors.\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing next information and don\'t duplicate information in User Input. If in User Input there is no information related to the skills the user already has related to the goal, ask a question about it.\nexampleAnswer should be diverse and relevant to the question, including popular frameworks and underlying technologies.(3 example answers)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation(if enough return true, if not return false), if User input have 6 line return true.',
      },
      {
        text: 'output: {"nextQuestion": "What specific pieces of classical music do you enjoy or are interested in learning?","answer": "Music: ", "exampleAnswer": [{"content": "Mozart Sonatas"}, {"content": "Bach Preludes and Fugues"}, {"content": "Beethoven Piano Concertos"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals:  Study desgin\nType: Graphic Design\nSpecific: Logo design\n\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify  technologies or skills they need to learn\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nUsers will often learn on their own, so they will often learn using videos or online resources and without instructors.\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing next information and don\'t duplicate information in User Input. If in User Input there is no information related to the skills the user already has related to the goal, ask a question about it.\nexampleAnswer should be diverse and relevant to the question, including popular frameworks and underlying technologies.(3 example answers)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation(if enough return true, if not return false), if User input have 6 line return true.',
      },
      {
        text: 'output: {"nextQuestion": "What specific software or tools are you interested in learning for logo design?", "answer": "Software: ", "exampleAnswer": [{"content": "Adobe Illustrator"}, {"content": "Canva"}, {"content": "Figma"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals:  Learn programming\nLanguage: Python\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify  technologies or skills they need to learn.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nUsers will often learn on their own, so they will often learn using videos or online resources.\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing next information and don\'t duplicate information in User Input. If in User Input there is no information related to the skills the user already has related to the goal, ask a question about it.\nexampleAnswer should be diverse and relevant to the question, including popular frameworks and underlying technologies.(3 example answers)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation(if enough return true, if not return false), if User input have 6 line return true.',
      },
      {
        text: 'output: {"nextQuestion": "What specific areas or applications of Python are you most interested in?", "answer": "Areas: ", "exampleAnswer": [{"content": "Data Science and Machine Learning"}, {"content": "Web Development"}, {"content": "Automation and Scripting"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals: Learn communication\nSpecific: Public Speaking \n\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify  technologies or skills they need to learn\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nUsers will often learn on their own, so they will often learn using videos or online resources and without instructors.\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing next information and don\'t duplicate information in User Input. If in User Input there is no information related to the skills the user already has related to the goal, ask a question about it.\nexampleAnswer should be diverse and relevant to the question, including popular frameworks and underlying technologies.(3 example answers)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation(if enough return true, if not return false), if User input have 6 line return true.',
      },
      {
        text: 'output: {"nextQuestion": "What specific types of public speaking are you interested in or do you need to develop skills for?", "answer": "Type: ", "exampleAnswer": [{"content": "Presentations at work"}, {"content": "Public speeches"}, {"content": "Toastmastering"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals:  Learn painting \nStyle: Acrylic\n\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify the most specific technologies or skills they need to learn.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing next information and don\'t duplicate information in User Input.If in User Input there is no information related to the skills the user already has related to the goal, ask a question about it.\nexampleAnswer should be diverse and relevant to the question, including popular frameworks and underlying technologies.(3 example answers)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation(if enough return true, if not return false), if User input have 6 line return true.',
      },
      {
        text: 'output: {"nextQuestion": "What specific subjects or types of acrylic painting are you interested in exploring?", "answer": "Subjects: ", "exampleAnswer": [{"content": "Landscapes"}, {"content": "Portraits"}, {"content": "Abstract Art"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals:  Learn content creation\nInterested: Blog post\nTopic: Food\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify the most specific technologies or skills they need to learn.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing next information.\nexampleAnswer should be diverse and relevant to the question, including popular frameworks and underlying technologies.(3 example answers)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation(if enough return true, if not return false), if User input have 6 line return true.',
      },
      {
        text: 'output: {"nextQuestion": "What specific type of food blog are you interested in creating?", "answer": "Food Type: ", "exampleAnswer": [{"content": "Recipes"}, {"content": "Restaurant Reviews"}, {"content": "Food Photography and Styling"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals: Learn French \nLevel: Basic knowledge\nGoal: Basic communicate\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify the most specific technologies or skills they need to learn.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing next information.\nexampleAnswer should be diverse and relevant to the question, including popular frameworks and underlying technologies.(3 example answers)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation(if enough return true, if not return false), if User input have 6 line return true.',
      },
      {
        text: 'output: {"nextQuestion": "What are your specific communication goals in French? (e.g., travel, work, social interaction)", "answer": "Goals: ", "exampleAnswer": [{"content": "Traveling to France"}, {"content": "Working in a French-speaking environment"}, {"content": "Socializing with French speakers"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals:  Learn how to tip beautiful photos\nTools: Iphone \n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify  technologies or skills they need to learn\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nUsers will often learn on their own, so they will often learn using videos or online resources and without instructors.\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing next information and don\'t duplicate information in User Input. If in User Input there is no information related to the skills the user already has related to the goal, ask a question about it.\nexampleAnswer should be diverse and relevant to the question, including popular frameworks and underlying technologies.(3 example answers)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation(if enough return true, if not return false), if User input have 6 line return true.',
      },
      {
        text: 'output: {"nextQuestion": "What specific aspects of photo editing are you most interested in learning for your iPhone?", "answer": "Aspects: ", "exampleAnswer": [{"content": "Basic Editing (brightness, contrast, cropping)"}, {"content": "Color Correction and Enhancement"}, {"content": "Using filters and presets"}], "status": "false"}',
      },
      {
        text: `input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\n${info}\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify  technologies or skills they need to learn\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nUsers will often learn on their own, so they will often learn using videos or online resources and without instructors.\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing next information and don\'t duplicate information in User Input. If in User Input there is no information related to the skills the user already has related to the goal, ask a question about it.\nexampleAnswer should be diverse and relevant to the question, including popular frameworks and underlying technologies.(3 example answers)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation(if enough return true, if not return false), if User input have 6 line return true.`,
      },
      { text: 'output: ' },
    ];
    const result = await this.model.generateContent({
      contents: [{ role: 'user', parts }],
      generationConfig: this.generationConfig,
    });
    const res = await result.response.text();
    const resJson = await JSON.parse(res);

    console.log(resJson);
    return resJson;
  }

  async generateQuestion2(info: string) {
    console.log(info);
    const parts = [
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals: Study AWS\nGoal: AWS Solutions Architect Associate certification\nExperience Level: Beginner\n\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify the most specific technologies or skills they need to learn.\nanswer: A placeholder for the user\'s answer to the question.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nIf user input have 6 row\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing more specific information.\nThe exampleAnswer should be diverse and relevant to AWS, covering both popular frameworks and fundamental technologies.(3 exampleAnswer)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation.',
      },
      {
        text: 'output: {"nextQuestion": "What specific AWS services are you most interested in learning about or working with?","answer": "Services: ", "exampleAnswer": [{"content": "EC2 (Elastic Compute Cloud)"}, {"content": "S3 (Simple Storage Service)"}, {"content": "Lambda (Serverless Computing)"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals:  Play piano\nExperience Level: Beginner\nStyle: Romantic\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify the most specific technologies or skills they need to learn.\nanswer: A placeholder for the user\'s answer to the question.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing more specific information.\nThe exampleAnswer should be diverse and relevant to AWS, covering both popular frameworks and fundamental technologies.(3 exampleAnswer)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation.',
      },
      {
        text: 'output: {"nextQuestion": "What specific pieces of classical music do you enjoy or are interested in learning?","answer": "Music: ", "exampleAnswer": [{"content": "Mozart Sonatas"}, {"content": "Bach Preludes and Fugues"}, {"content": "Beethoven Piano Concertos"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals:  Study desgin\nType: Graphic Design\nSpecific: Logo design\n\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify the most specific technologies or skills they need to learn.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing more specific information.\nThe exampleAnswer should be diverse and relevant to AWS, covering both popular frameworks and fundamental technologies.(3 exampleAnswer)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation.',
      },
      {
        text: 'output: {"nextQuestion": "What specific software or tools are you interested in learning for logo design?", "answer": "Software: ", "exampleAnswer": [{"content": "Adobe Illustrator"}, {"content": "Canva"}, {"content": "Figma"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals:  Learn programming\nLanguage: Python\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify the most specific technologies or skills they need to learn.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing more specific information.\nThe exampleAnswer should be diverse and relevant to AWS, covering both popular frameworks and fundamental technologies.(3 exampleAnswer)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation.',
      },
      {
        text: 'output: {"nextQuestion": "What specific areas or applications of Python are you most interested in?", "answer": "Areas: ", "exampleAnswer": [{"content": "Data Science and Machine Learning"}, {"content": "Web Development"}, {"content": "Automation and Scripting"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals: Learn communication\nSpecific: Public Speaking \n\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify the most specific technologies or skills they need to learn.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing more specific information.\nThe exampleAnswer should be diverse and relevant to AWS, covering both popular frameworks and fundamental technologies.(3 exampleAnswer)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation.',
      },
      {
        text: 'output: {"nextQuestion": "What specific types of public speaking are you interested in or do you need to develop skills for?", "answer": "Type: ", "exampleAnswer": [{"content": "Presentations at work"}, {"content": "Public speeches"}, {"content": "Toastmastering"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals:  Learn painting \nStyle: Acrylic\n\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify the most specific technologies or skills they need to learn.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing more specific information.\nThe exampleAnswer should be diverse and relevant to AWS, covering both popular frameworks and fundamental technologies.(3 exampleAnswer)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation.',
      },
      {
        text: 'output: {"nextQuestion": "What specific subjects or types of acrylic painting are you interested in exploring?", "answer": "Subjects: ", "exampleAnswer": [{"content": "Landscapes"}, {"content": "Portraits"}, {"content": "Abstract Art"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals:  Learn content creation\nInterested: Blog post\nTopic: Food\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify the most specific technologies or skills they need to learn.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing more specific information.\nThe exampleAnswer should be diverse and relevant to AWS, covering both popular frameworks and fundamental technologies.(3 exampleAnswer)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation.',
      },
      {
        text: 'output: {"nextQuestion": "What specific type of food blog are you interested in creating?", "answer": "Food Type: ", "exampleAnswer": [{"content": "Recipes"}, {"content": "Restaurant Reviews"}, {"content": "Food Photography and Styling"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals: Learn French \nLevel: Basic knowledge\nGoal: Basic communicate\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify the most specific technologies or skills they need to learn.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing more specific information.\nThe exampleAnswer should be diverse and relevant to AWS, covering both popular frameworks and fundamental technologies.(3 exampleAnswer)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation.',
      },
      {
        text: 'output: {"nextQuestion": "What are your specific communication goals in French? (e.g., travel, work, social interaction)", "answer": "Goals: ", "exampleAnswer": [{"content": "Traveling to France"}, {"content": "Working in a French-speaking environment"}, {"content": "Socializing with French speakers"}], "status": "false"}',
      },
      {
        text: 'input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\nPersonal or Career Goals:  Learn how to tip beautiful photos\nTools: Iphone \n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify the most specific technologies or skills they need to learn.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing more specific information.\nThe exampleAnswer should be diverse and relevant to AWS, covering both popular frameworks and fundamental technologies.(3 exampleAnswer)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation.\nLet me know if you have any other questions or need further assistance.',
      },
      {
        text: 'output: {"nextQuestion": "What specific aspects of photo editing are you most interested in learning for your iPhone?", "answer": "Aspects: ", "exampleAnswer": [{"content": "Basic Editing (brightness, contrast, cropping)"}, {"content": "Color Correction and Enhancement"}, {"content": "Using filters and presets"}], "status": "false"}',
      },
      {
        text: `input: You are a helpful AI assistant that guides users in creating a personalized learning roadmap.\n\nUser Input:\n${info}\n\nBased on the user input, generate a JSON object containing the following:\nnextQuestion: A general and brief question asking the user to gather more information. This question should align with user input and help identify the most specific technologies or skills they need to learn.\nexampleAnswer: An array three sample answers to the question, providing the most relevant context and guidance and direction for the user.\nstatus: A boolean value indicating whether enough information has been gathered to create a roadmap. Since the user input is very general, set this to "false".\n\nExample Output:\n{"nextQuestion": "What specific front-end technologies are you interested in learning or improving upon?","answer":"Interest: ", "exampleAnswer": [{"content": "React"}, {"content": "Angular"}, {"content": "Vue.js"}], "status":"false"}\n\nUse code with caution.\nJson\nRemember:\nThe nextQuestion should be tailored to the user\'s input and guide them towards providing more specific information.\nThe exampleAnswer should be diverse and relevant to AWS, covering both popular frameworks and fundamental technologies.(3 exampleAnswer)\nThe status should accurately reflect whether enough information has been gathered to proceed with roadmap creation.\nLet me know if you have any other questions or need further assistance.`,
      },
      { text: 'output: ' },
    ];

    const result = await this.model.generateContent({
      contents: [{ role: 'user', parts }],
      generationConfig: this.generationConfig,
      // safetySettings: Adjust safety settings
      // See https://ai.google.dev/gemini-api/docs/safety-settings
    });

    const res = await result.response.text();
    const resJson = await JSON.parse(res);
    console.log(resJson);

    return resJson;
  }

  async generateQuestion3(info: string) {
    const parts = [
      {
        text: 'input: Generate next question and answer is keyword  relate to content and 3 examples content:\nPersonal or Career Goals:  Study AWS\nCurrent Skill Level: Beginner\nInterest: DevOps',
      },
      {
        text: 'output: {\n"nextQuestion": "What is your preferred learning style?",\n"answer":"Interest: ",\n"exampleAnswer": [\n{"content":"Reading"},\n{"content":"Online courses"},\n{"content":"Hands-on labs"},\n]\n}',
      },
      {
        text: 'input: Generate next question and answer is keyword  relate to content and 3 examples content:\nPersonal or Career Goals: Front-end Developer\nInterest: React\nExperience Level: Beginner',
      },
      {
        text: 'output: {\n"nextQuestion": "What is your preferred learning style?",\n"answer":"Interest: ",\n"exampleAnswer": [\n{"content":"Reading"},\n{"content":"Online courses"},\n{"content":"Hands-on labs"},\n]\n}',
      },
      {
        text: "input: Generate next question and answer is keyword  relate to content and 3 examples content:\nPersonal or Career Goals: Piano\nKnowledge: I don't have any knowledge about music\nGoals: Learn basic chords and melodies",
      },
      {
        text: 'output: {"nextQuestion": "What is your preferred learning style?", "answer":"Interest: ", "exampleAnswer": [{"content":"Video"}, {"content":"Online courses"}, {"content":"Practice"}]}',
      },
      {
        text: 'input: Generate next question and answer is keyword  relate to content and 3 examples content:\nPersonal or Career Goals: Guitar\nGuitar Type: Acoustic\nExperience Level: Intermediate',
      },
      {
        text: 'output: {"nextQuestion": "What is your preferred learning style?", "answer":"Interest: ", "exampleAnswer": [{"content":"Video"}, {"content":"Online courses"}, {"content":"Practice"}]}',
      },
      {
        text: `input: Generate next question and answer is keyword  relate to content and 3 examples content: \n${info}`,
      },
      { text: 'output: ' },
    ];

    const result = await this.model.generateContent({
      contents: [{ role: 'user', parts }],
      generationConfig: this.generationConfig,
      // safetySettings: Adjust safety settings
      // See https://ai.google.dev/gemini-api/docs/safety-settings
    });

    const res = await result.response.text();
    const resJson = await JSON.parse(res);
    console.log(resJson);

    return resJson;
  }

  async generateRoadmap(user: User, info: string, title: string) {
    const parts = [
      {
        text: 'input: You are an AI assistant helping a university student create a personalized roadmap to study AWS.\n\nGiven the following user information and goals, generate a detailed roadmap in JSON format.\n\n**User Information:**\n\n- Age: 20\n- Gender: Male\n- Location: Ha Noi\n- Occupation: Student\n\n**Goals and Expectations:**\n\n-Personal or Career Goals:  Study AWS\n-Current Skill Level: Beginner\n-Interest: DevOps\n-Interest: Online Course\n\n**Roadmap Structure:**\n\nThe roadmap should be structured as follows:\n\n* **Stages:** Each stage represents a major phase in the learning journey.\n    * **Name:** A descriptive name for the stage.\n    * **Timeframe:** Estimated duration of the stage (e.g., "3 months").\n    * **Tasks:** A list of tasks to be completed within the stage.\n* **Tasks:** Each task represents a specific learning objective.\n    * **Name:** A clear and concise name for the task.\n    * **Description:** A detailed explanation of what the task entails.\n    * **Time:** Estimated time required to complete the task.\n    * **Subtasks:** A list of smaller, actionable steps to achieve the task.\n* **Subtasks:**\n    * **Name:** A descriptive name for the subtask.\n    * **Description:** A brief explanation of the subtask.\n    * **Resources:** Links to relevant learning resources, resource links must be usable and must not appear 404 errors (e.g., online courses, tutorials, documentation)\n    * **Time:** Estimated time required to complete the subtask.\n    * **Quiz:** Empty array \n\n\n**Example JSON Structure:**\n\n{\n  "Roadmap": {\n    "Stages": [\n      {\n        "Name": "Stage 1 Name",\n        "Timeframe": "3 months",\n        "Tasks": [\n          {\n            "Name": "Task 1 Name",\n            "Description": "Task 1 Description",\n            "Time": "1 month",\n            "Subtasks": [\n              {\n                "Name": "Subtask 1 Name",\n                "Description": "Subtask 1 Description",\n                 "Resources": ["Resource 1 Link", "Resource 2 Link", "Resource 3 Link", {... more resources}\n],\n                "Time": "1 week"\n              },\n              // ... more subtasks(minimum 4 subtasks)\n            ]\n          },\n          // ... more tasks(minimum 3 tasks)\n        ]\n      },\n      // ... more stages(minimum 2 stages)\n    ]\n  }\n}\n\n\n**Important Notes:**\n\n* Tailor the roadmap to the user\'s age, location, occupation, and specific goals.\n* Provide realistic timeframes and suggest relevant resources for each subtask.\n* Ensure the JSON output is well-formatted and easy to read.',
      },
      {
        text: 'output: {"Roadmap": {"Stages": [{"Name": "AWS Fundamentals", "Timeframe": "2 months", "Tasks": [{"Name": "AWS Concepts and Services", "Description": "Gain a foundational understanding of AWS core concepts, key services, and the AWS cloud architecture.", "Time": "1 month", "Subtasks": [{"Name": "Introduction to AWS", "Description": "Learn about the history, benefits, and use cases of AWS.", "Resources": ["https://aws.amazon.com/what-is-aws/", "https://www.youtube.com/watch?v=Y-d3cV4T64c"], "Time": "1 week"}, {"Name": "AWS Global Infrastructure", "Description": "Explore the AWS global infrastructure, regions, and availability zones.", "Resources": ["https://aws.amazon.com/about-aws/global-infrastructure/"], "Time": "1 week"}, {"Name": "Compute Services (EC2, Lambda)", "Description": "Understand the different types of compute services available on AWS, including EC2 and Lambda.", "Resources": ["https://aws.amazon.com/ec2/", "https://aws.amazon.com/lambda/"], "Time": "1 week"}, {"Name": "Storage Services (S3, EBS)", "Description": "Learn about AWS storage options, including S3 for object storage and EBS for block storage.", "Resources": ["https://aws.amazon.com/s3/", "https://aws.amazon.com/ebs/"], "Time": "1 week"}, {"Name": "Networking Services (VPC, Route 53)", "Description": "Explore the AWS networking model, including VPCs, subnets, and Route 53 for DNS.", "Resources": ["https://aws.amazon.com/vpc/", "https://aws.amazon.com/route-53/"], "Time": "1 week"}]}, {"Name": "Hands-on Practice with AWS", "Description": "Apply your knowledge by working through practical exercises and building simple AWS projects.", "Time": "1 month", "Subtasks": [{"Name": "Create an AWS Account", "Description": "Sign up for a free AWS account and familiarize yourself with the AWS Management Console.", "Resources": ["https://aws.amazon.com/free/"], "Time": "1 week"}, {"Name": "Launch an EC2 Instance", "Description": "Learn how to launch and configure a virtual machine (EC2 instance) on AWS.", "Resources": ["https://aws.amazon.com/getting-started/tutorials/launch-an-ec2-instance/"], "Time": "1 week"}, {"Name": "Deploy a Simple Web Application", "Description": "Build a basic web application using AWS services and deploy it to AWS.", "Resources": ["https://aws.amazon.com/getting-started/tutorials/deploy-a-web-application/"], "Time": "2 weeks"}, {"Name": "Explore AWS Console and CLI", "Description": "Gain proficiency in using the AWS Management Console and the AWS Command Line Interface (CLI).", "Resources": ["https://aws.amazon.com/console/", "https://aws.amazon.com/cli/"], "Time": "1 week"}]}]}, {"Name": "DevOps with AWS", "Timeframe": "3 months", "Tasks": [{"Name": "Infrastructure as Code (IaC)", "Description": "Learn about Infrastructure as Code (IaC) and its benefits. Master tools like CloudFormation and Terraform for automated infrastructure provisioning.", "Time": "1.5 months", "Subtasks": [{"Name": "Introduction to IaC", "Description": "Understand the principles of Infrastructure as Code (IaC) and its advantages.", "Resources": ["https://aws.amazon.com/solutions/infrastructure-as-code/"], "Time": "1 week"}, {"Name": "AWS CloudFormation", "Description": "Learn how to use AWS CloudFormation to define and manage your AWS resources using templates.", "Resources": ["https://aws.amazon.com/cloudformation/"], "Time": "3 weeks"}, {"Name": "Terraform for AWS", "Description": "Explore Terraform, an open-source tool, to manage AWS infrastructure using declarative configuration.", "Resources": ["https://www.terraform.io/docs/providers/aws/index.html"], "Time": "3 weeks"}, {"Name": "Practical IaC Projects", "Description": "Build real-world IaC projects using either CloudFormation or Terraform.", "Resources": ["https://github.com/hashicorp/terraform-aws-examples"], "Time": "2 weeks"}]}, {"Name": "CI/CD Pipelines with AWS", "Description": "Learn to create Continuous Integration/Continuous Deployment (CI/CD) pipelines using AWS services like CodePipeline and CodeBuild.", "Time": "1 month", "Subtasks": [{"Name": "AWS CodePipeline", "Description": "Learn about AWS CodePipeline and its role in automating the release process.", "Resources": ["https://aws.amazon.com/codepipeline/"], "Time": "2 weeks"}, {"Name": "AWS CodeBuild", "Description": "Understand how AWS CodeBuild works to build, test, and package your applications.", "Resources": ["https://aws.amazon.com/codebuild/"], "Time": "2 weeks"}, {"Name": "Building CI/CD Pipelines", "Description": "Practice creating CI/CD pipelines using AWS CodePipeline and CodeBuild.", "Resources": ["https://aws.amazon.com/getting-started/tutorials/build-a-ci-cd-pipeline/"], "Time": "2 weeks"}, {"Name": "Implementing CI/CD best practices", "Description": "Learn about best practices for designing and implementing efficient and secure CI/CD pipelines.", "Resources": ["https://aws.amazon.com/blogs/devops/best-practices-for-building-continuous-delivery-pipelines-on-aws/"], "Time": "1 week"}]}, {"Name": "Monitoring and Logging", "Description": "Learn how to monitor and log your AWS applications and infrastructure using services like CloudWatch and CloudTrail.", "Time": "0.5 months", "Subtasks": [{"Name": "AWS CloudWatch", "Description": "Explore AWS CloudWatch for monitoring your applications and infrastructure.", "Resources": ["https://aws.amazon.com/cloudwatch/"], "Time": "2 weeks"}, {"Name": "AWS CloudTrail", "Description": "Understand how to use CloudTrail to audit and track activity in your AWS environment.", "Resources": ["https://aws.amazon.com/cloudtrail/"], "Time": "1 week"}, {"Name": "Setting up Monitoring and Logging", "Description": "Configure CloudWatch and CloudTrail to monitor and log your AWS resources.", "Resources": ["https://aws.amazon.com/getting-started/tutorials/monitor-your-applications/"], "Time": "2 weeks"}]}]}]}}',
      },
      {
        text: 'input: You are an AI assistant helping a university student create a personalized roadmap to become a front-end developer.\n\nGiven the following user information and goals, generate a detailed roadmap in JSON format.\n\n**User Information:**\n\n- Age: 20\n- Gender: Male\n- Location: Ha Noi\n- Occupation: Student\n\n**Goals and Expectations:**\n\n- Personal or Career Goals: Front-end Developer\n -Interest: React\n- Experience Level: Beginner\n-Interest: Online course\n\n\n**Roadmap Structure:**\n\nThe roadmap should be structured as follows:\n\n* **Stages:** Each stage represents a major phase in the learning journey.\n    * **Name:** A descriptive name for the stage.\n    * **Timeframe:** Estimated duration of the stage (e.g., "3 months").\n    * **Tasks:** A list of tasks to be completed within the stage.\n* **Tasks:** Each task represents a specific learning objective.\n    * **Name:** A clear and concise name for the task.\n    * **Description:** A detailed explanation of what the task entails.\n    * **Time:** Estimated time required to complete the task.\n    * **Subtasks:** A list of smaller, actionable steps to achieve the task.\n* **Subtasks:**\n    * **Name:** A descriptive name for the subtask.\n    * **Description:** A brief explanation of the subtask.\n    * **Resources:** Links to relevant learning resources, resource links must be usable and must not appear 404 errors (e.g., online courses, tutorials, documentation)\n    * **Time:** Estimated time required to complete the subtask.\n    * **Quiz:** Empty array \n\n\n**Example JSON Structure:**\n\n{\n  "Roadmap": {\n    "Stages": [\n      {\n        "Name": "Stage 1 Name",\n        "Timeframe": "3 months",\n        "Tasks": [\n          {\n            "Name": "Task 1 Name",\n            "Description": "Task 1 Description",\n            "Time": "1 month",\n            "Subtasks": [\n              {\n                "Name": "Subtask 1 Name",\n                "Description": "Subtask 1 Description",\n                 "Resources": ["Resource 1 Link", "Resource 2 Link", "Resource 3 Link", {... more resources}\n],\n                "Time": "1 week"\n              },\n              // ... more subtasks(minimum 4 subtasks)\n            ]\n          },\n          // ... more tasks(minimum 3 tasks)\n        ]\n      },\n      // ... more stages(minimum 2 stages)\n    ]\n  }\n}\n\n**Important Notes:**\n\n* Tailor the roadmap to the user\'s age, location, occupation, and specific goals.\n* Provide realistic timeframes and suggest relevant resources for each subtask.\n* Ensure the JSON output is well-formatted and easy to read.',
      },
      {
        text: 'output: {"Roadmap": {"Stages": [{"Name": "HTML, CSS, and JavaScript Fundamentals", "Timeframe": "2 months", "Tasks": [{"Name": "HTML Basics", "Description": "Learn the fundamental building blocks of web pages, including tags, attributes, and basic structure.", "Time": "2 weeks", "Subtasks": [{"Name": "HTML Structure and Elements", "Description": "Understand the structure of an HTML document, common elements like headings, paragraphs, lists, and tables.", "Resources": ["https://www.w3schools.com/html/", "https://developer.mozilla.org/en-US/docs/Web/HTML"], "Time": "1 week"}, {"Name": "HTML Attributes and Styling", "Description": "Learn about HTML attributes and how to use CSS for basic styling.", "Resources": ["https://www.w3schools.com/html/html_attributes.asp", "https://www.w3schools.com/css/"], "Time": "1 week"}]}, {"Name": "CSS Fundamentals", "Description": "Master CSS concepts, selectors, properties, and layout techniques.", "Time": "3 weeks", "Subtasks": [{"Name": "CSS Selectors", "Description": "Learn various CSS selectors for targeting specific elements on a web page.", "Resources": ["https://www.w3schools.com/css/css_selectors.asp", "https://developer.mozilla.org/en-US/docs/Web/CSS/Selectors"], "Time": "1 week"}, {"Name": "CSS Properties and Values", "Description": "Explore common CSS properties (e.g., color, font, background) and their values.", "Resources": ["https://www.w3schools.com/css/css_intro.asp", "https://developer.mozilla.org/en-US/docs/Web/CSS/Properties"], "Time": "1 week"}, {"Name": "CSS Layout Techniques", "Description": "Learn about different CSS layout methods, such as flexbox, grid, and floats.", "Resources": ["https://css-tricks.com/snippets/css/a-guide-to-flexbox/", "https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Grid_Layout", "https://www.w3schools.com/css/css_float.asp"], "Time": "1 week"}]}, {"Name": "JavaScript Essentials", "Description": "Learn the basics of JavaScript, including variables, data types, operators, and control flow.", "Time": "4 weeks", "Subtasks": [{"Name": "JavaScript Basics", "Description": "Get introduced to JavaScript syntax, variables, data types, and operators.", "Resources": ["https://www.w3schools.com/js/default.asp", "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide"], "Time": "2 weeks"}, {"Name": "JavaScript Functions and Control Flow", "Description": "Learn about functions, control structures (if/else, loops), and how to manipulate data in JavaScript.", "Resources": ["https://www.w3schools.com/js/js_functions.asp", "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements"], "Time": "2 weeks"}]}]}, {"Name": "Introduction to React", "Timeframe": "2 months", "Tasks": [{"Name": "React Fundamentals", "Description": "Learn the core concepts of React, including components, JSX, state, props, and lifecycle methods.", "Time": "1 month", "Subtasks": [{"Name": "React Components and JSX", "Description": "Understand the concept of components in React and how to use JSX for declarative UI rendering.", "Resources": ["https://reactjs.org/docs/introducing-jsx.html", "https://www.freecodecamp.org/news/react-jsx-explained-for-beginners/"], "Time": "2 weeks"}, {"Name": "React State and Props", "Description": "Learn about managing component state and passing data between components using props.", "Resources": ["https://reactjs.org/docs/state-and-lifecycle.html", "https://www.freecodecamp.org/news/react-state-and-props-explained-for-beginners/"], "Time": "2 weeks"}, {"Name": "React Lifecycle Methods", "Description": "Explore the different lifecycle methods of React components and their uses.", "Resources": ["https://reactjs.org/docs/state-and-lifecycle.html", "https://www.freecodecamp.org/news/react-lifecycle-methods-explained-for-beginners/"], "Time": "2 weeks"}, {"Name": "Building a Simple React App", "Description": "Create a basic React application to solidify your understanding of core concepts.", "Resources": ["https://create-react-app.dev/", "https://reactjs.org/docs/getting-started.html"], "Time": "2 weeks"}]}, {"Name": "React Advanced Concepts", "Description": "Dive deeper into React features, including routing, state management, and building complex applications.", "Time": "1 month", "Subtasks": [{"Name": "React Router", "Description": "Learn how to implement navigation and routing in React applications using React Router.", "Resources": ["https://reactrouter.com/docs/en/v6", "https://www.freecodecamp.org/news/react-router-tutorial/"], "Time": "2 weeks"}, {"Name": "State Management with Redux", "Description": "Explore Redux for managing application state efficiently, especially in large-scale projects.", "Resources": ["https://redux.js.org/", "https://www.freecodecamp.org/news/redux-tutorial-for-beginners/"], "Time": "2 weeks"}, {"Name": "Building a Real-World React Project", "Description": "Work on a more complex React project to apply your knowledge and gain hands-on experience.", "Resources": ["https://github.com/facebook/create-react-app", "https://www.freecodecamp.org/learn/front-end-libraries/react"], "Time": "2 weeks"}, {"Name": "React Testing", "Description": "Learn how to write unit tests for your React components.", "Resources": ["https://reactjs.org/docs/testing.html", "https://jestjs.io/docs/en/getting-started"], "Time": "2 weeks"}]}]}, {"Name": "Portfolio and Job Search", "Timeframe": "1 month", "Tasks": [{"Name": "Create a Front-end Portfolio", "Description": "Showcase your skills and projects by building a professional portfolio website.", "Time": "2 weeks", "Subtasks": [{"Name": "Portfolio Website Design", "Description": "Plan the design and layout of your portfolio, focusing on showcasing your projects effectively.", "Resources": ["https://www.awwwards.com/", "https://dribbble.com/"], "Time": "1 week"}, {"Name": "Build a Portfolio Website", "Description": "Use your HTML, CSS, and JavaScript knowledge to build a responsive and visually appealing portfolio website.", "Resources": ["https://www.freecodecamp.org/learn/front-end-libraries/react/build-a-portfolio-website", "https://www.w3schools.com/html/", "https://www.w3schools.com/css/"], "Time": "1 week"}]}, {"Name": "Job Search Strategies", "Description": "Learn effective job search techniques, including networking, online platforms, and resume/cover letter writing.", "Time": "1 week", "Subtasks": [{"Name": "Networking and Job Boards", "Description": "Explore online job boards and professional networks to find relevant job openings.", "Resources": ["https://www.linkedin.com/", "https://www.indeed.com/"], "Time": "1 week"}, {"Name": "Resume and Cover Letter Writing", "Description": "Learn how to write compelling resumes and cover letters that highlight your skills and experience.", "Resources": ["https://www.indeed.com/career-advice/resumes-cover-letters/resume-templates", "https://www.indeed.com/career-advice/resumes-cover-letters/cover-letter-samples"], "Time": "1 week"}]}, {"Name": "Interview Preparation", "Description": "Prepare for technical and behavioral interviews by practicing common questions and refining your answers.", "Time": "1 week", "Subtasks": [{"Name": "Front-end Interview Questions", "Description": "Research common front-end interview questions and prepare answers that demonstrate your understanding of concepts.", "Resources": ["https://www.freecodecamp.org/news/front-end-interview-questions-and-answers/", "https://www.interviewcake.com/"], "Time": "1 week"}, {"Name": "Behavioral Interview Practice", "Description": "Practice answering behavioral questions that assess your soft skills and problem-solving abilities.", "Resources": ["https://www.indeed.com/career-advice/interviewing/behavioral-interview-questions", "https://www.interviewcake.com/"], "Time": "1 week"}]}]}]}}',
      },
      {
        text: `input: You are an AI assistant helping a university student create a personalized roadmap.\n\nGiven the following user information and goals, generate a detailed roadmap in JSON format.\n\n**User Information:**\n\n- Age: ${user.age}\n- Gender: ${user.gender}\n- Location: ${user.location}\n- Occupation: ${user.occupation}\n\n**Goals and Expectations:**\n\n${info}\n\n\n**Roadmap Structure:**\n\nThe roadmap should be structured as follows:\n\n* **Stages:** Each stage represents a major phase in the learning journey.\n    * **Name:** A descriptive name for the stage.\n    * **Timeframe:** Estimated duration of the stage (e.g., "3 months").\n    * **Tasks:** A list of tasks to be completed within the stage.\n* **Tasks:** Each task represents a specific learning objective.\n    * **Name:** A clear and concise name for the task.\n    * **Description:** A detailed explanation of what the task entails.\n    * **Time:** Estimated time required to complete the task.\n    * **Subtasks:** A list of smaller, actionable steps to achieve the task.\n* **Subtasks:**\n    * **Name:** A descriptive name for the subtask.\n    * **Description:** A brief explanation of the subtask.\n    * **Resources:** Links to relevant learning resources, resource links must be usable and must not appear 404 errors (e.g., online courses, tutorials, documentation)\n    * **Time:** Estimated time required to complete the subtask.\n    * **Quiz:** Empty array \n\n**Example JSON Structure:**\n\n{\n  "Roadmap": {\n    "Stages": [\n      {\n        "Name": "Stage 1 Name",\n        "Timeframe": "3 months",\n        "Tasks": [\n          {\n            "Name": "Task 1 Name",\n            "Description": "Task 1 Description",\n            "Time": "1 month",\n            "Subtasks": [\n              {\n                "Name": "Subtask 1 Name",\n                "Description": "Subtask 1 Description",\n                "Resources": ["Resource 1 Link", "Resource 2 Link", "Resource 3 Link", {... more resources}\n],\n                "Time": "1 week",\n                "Quiz": []\n              },\n              // ... more subtasks(minimum 4 subtasks)\n            ]\n          },\n          // ... more tasks(minimum 3 tasks)\n        ]\n      },\n      // ... more stages(minimum 2 stages)\n    ]\n  }\n}\n\n**Important Notes:**\n\n* Tailor the roadmap to the user\'s age, location, occupation, and specific goals.\n* Provide realistic timeframes and suggest relevant resources for each subtask.\n* Ensure the JSON output is well-formatted and easy to read.`,
      },
      { text: 'output: ' },
    ];
    const result = await this.model.generateContent({
      contents: [{ role: 'user', parts }],
      generationConfig: {
        ...this.generationConfig,
        maxOutputTokens: 10000,
        temperature: 0.4,
      },
      // safetySettings: Adjust safety settings
      // See https://ai.google.dev/gemini-api/docs/safety-settings
    });

    const res = result.response.text();
    // const jsonString = await this.createJsonString(res);
    // console.log(jsonString);
    console.log(info);
    const resJson = await JSON.parse(res);

    console.log(resJson);

    const roadmap = await this.prismaService.roadmap.create({
      data: {
        userId: user.id,
        title,
        stages: resJson.Roadmap.Stages,
      },
    });

    return roadmap;
  }

  async getRoadmap(id: string) {
    const roadmap = await this.prismaService.roadmap.findUnique({
      where: {
        id,
      },
    });

    return roadmap;
  }

  async createJsonString(data: string) {
    return JSON.stringify(data);
  }
}
